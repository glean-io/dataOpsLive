glean: "1.0"
type: model
grn: m:4b9c282f-7860-3be0-8087-83116ca15724
name: Monthly Recurring Revenue
source:
  connectionName: demo_snowflake
  physicalName: mrr
  schema: dev_dse
cols:
  - id: date_month
    type: datetime
    physicalName: date_month
    name: date_month
    primaryDate: true
    aggregationOptions:
      minGranularity: month
      maxGranularity: year
  - id: first_active_month
    type: datetime
    physicalName: first_active_month
    name: first_active_month
    primaryDate: false
    aggregationOptions:
      minGranularity: month
      maxGranularity: year
  - id: last_active_month
    type: datetime
    physicalName: last_active_month
    name: last_active_month
    primaryDate: false
    aggregationOptions:
      minGranularity: month
      maxGranularity: year
  - id: is_active
    type: attribute
    physicalName: is_active
    name: is_active
  - id: is_first_month
    type: attribute
    physicalName: is_first_month
    name: is_first_month
  - id: is_last_month
    type: attribute
    physicalName: is_last_month
    name: is_last_month
  - id: change_category
    type: attribute
    physicalName: change_category
    name: Change Category
  - id: renewal_amount
    type: attribute
    physicalName: renewal_amount_v2
    name: renewal_amount
  - id: customer_id
    type: attribute
    physicalName: customer_id
    name: customer_id
  - id: transactions
    type: metric
    name: Transactions
    aggregate: row_count
  - id: mrr_change
    type: metric
    name: MRR change
    formattingOptions:
      fixedDecimals: 0
      formatAsDollars: true
    aggregate: sum
    physicalName: mrr_change
  - id: customer_change
    type: metric
    name: Customer Change
    sql: |-
      sum(case
      when change_category in('new', 'reactivation') then 1
      when change_category in('churn') then -1
      end)
  - id: revenue
    type: metric
    name: Revenue
    description: Revenue
    formattingOptions:
      fixedDecimals: 0
      formatAsDollars: true
    aggregate: sum
    physicalName: renewal_amount_v2
  - id: customers
    type: metric
    name: customers
    aggregate: count_distinct
    physicalName: customer_id
  - id: arpu
    type: metric
    name: ARPU
    formattingOptions:
      fixedDecimals: 0
      formatAsDollars: true
    aggregate: avg
    physicalName: mrr
  - id: mrr
    type: metric
    name: MRR
    formattingOptions:
      fixedDecimals: 0
      formatAsDollars: true
    aggregate: sum
    physicalName: mrr
